/*
 * Uploadcare (2.8.0)
 * Date: 2016-03-14 17:51:13 +0300
 * Rev: 44f8f878e4
 */
!function(e,t){(function(){var t;t={},"object"==typeof module&&"object"==typeof module.exports?module.exports=t:window.uploadcare=t,e.namespace=function(t,i){var n,a,r,o,l;if(a=e,t)for(l=t.split("."),r=0,o=l.length;o>r;r++)n=l[r],a[n]||(a[n]={}),a=a[n];return i(a)},e.expose=function(i,n){var a,r,o,l,s,u,c;for(o=i.split("."),a=o.pop(),s=t,l=e,u=0,c=o.length;c>u;u++)r=o[u],s[r]||(s[r]={}),s=s[r],l=null!=l?l[r]:void 0;return s[a]=n||l[a]}}).call(this),function(){var t;e.version="2.8.0",e.jQuery=jQuery,t=e.expose,t("version"),t("jQuery"),t("plugin",function(t){return t(e)}),t("whenReady",function(e){return e()})}.call(this),window.XDomainRequest&&jQuery.ajaxTransport(function(e){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var t;return{send:function(i,n){function a(e,i,a,r){t.onload=t.onerror=t.ontimeout=function(){},t=void 0,n(e,i,a,r)}t=new XDomainRequest,t.onload=function(){a(200,"OK",{text:t.responseText},"Content-Type: "+t.contentType)},t.onerror=function(){a(404,"Not Found")},t.onprogress=function(){},t.ontimeout=function(){a(0,"timeout")},t.timeout=e.xdrTimeout||Number.MAX_VALUE,t.open(e.type,e.url.replace(/^https?:/,"")),t.send(e.hasContent&&e.data||null)},abort:function(){t&&(t.onerror=function(){},t.abort())}}}}),function(){e.namespace("utils.abilities",function(e){var t,i,n,a;e.fileAPI=!!(window.File&&window.FileList&&window.FileReader),e.sendFileAPI=!(!window.FormData||!e.fileAPI),e.dragAndDrop=function(){var e;return e=document.createElement("div"),"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),e.canvas=function(){var e;return e=document.createElement("canvas"),!(!e.getContext||!e.getContext("2d"))}(),e.fileDragAndDrop=e.fileAPI&&e.dragAndDrop,e.iOSVersion=null,(t=/^[^(]+\(iP(?:hone|od|ad);\s*(.+?)\)/.exec(navigator.userAgent))&&(n=/OS (\d)_(\d)/.exec(t[1]))&&(e.iOSVersion=+n[1]+n[2]/10),e.Blob=!1;try{new window.Blob&&(e.Blob=window.Blob)}catch(r){}return i=window.URL||window.webkitURL||!1,e.URL=i&&i.createObjectURL&&i,e.FileReader=(null!=(a=window.FileReader)?a.prototype.readAsArrayBuffer:void 0)&&window.FileReader})}.call(this),function(){var t,i={}.hasOwnProperty,n=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e},a=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){return function(){return e.apply(t,arguments)}},o=[].slice;t=e.jQuery,e.namespace("utils",function(e){var i;return e.Collection=function(){function e(e){var i,n,a;for(null==e&&(e=[]),this.onAdd=t.Callbacks(),this.onRemove=t.Callbacks(),this.onSort=t.Callbacks(),this.onReplace=t.Callbacks(),this.__items=[],n=0,a=e.length;a>n;n++)i=e[n],this.add(i)}return e.prototype.add=function(e){return this.__add(e,this.__items.length)},e.prototype.__add=function(e,t){return this.__items.splice(t,0,e),this.onAdd.fire(e,t)},e.prototype.remove=function(e){var i;return i=t.inArray(e,this.__items),-1!==i?this.__remove(e,i):void 0},e.prototype.__remove=function(e,t){return this.__items.splice(t,1),this.onRemove.fire(e,t)},e.prototype.clear=function(){var e,t,i,n,a,r;for(i=this.get(),this.__items.length=0,r=[],e=n=0,a=i.length;a>n;e=++n)t=i[e],r.push(this.onRemove.fire(t,e));return r},e.prototype.replace=function(e,i){var n;return e!==i&&(n=t.inArray(e,this.__items),-1!==n)?this.__replace(e,i,n):void 0},e.prototype.__replace=function(e,t,i){return this.__items[i]=t,this.onReplace.fire(e,t,i)},e.prototype.sort=function(e){return this.__items.sort(e),this.onSort.fire()},e.prototype.get=function(e){return null!=e?this.__items[e]:this.__items.slice(0)},e.prototype.length=function(){return this.__items.length},e}(),e.UniqCollection=function(e){n(t,e);function t(){return i=t.__super__.constructor.apply(this,arguments)}return t.prototype.add=function(e){return a.call(this.__items,e)>=0?void 0:t.__super__.add.apply(this,arguments)},t.prototype.__replace=function(e,i,n){return a.call(this.__items,i)>=0?this.remove(e):t.__super__.__replace.apply(this,arguments)},t}(e.Collection),e.CollectionOfPromises=function(e){n(i,e);function i(){this.onAnyProgress=r(this.onAnyProgress,this),this.onAnyFail=r(this.onAnyFail,this),this.onAnyDone=r(this.onAnyDone,this),this.anyDoneList=t.Callbacks(),this.anyFailList=t.Callbacks(),this.anyProgressList=t.Callbacks(),this.anyProgressList.add(function(e,i){return t(e).data("lastProgress",i)}),i.__super__.constructor.apply(this,arguments)}return i.prototype.onAnyDone=function(e){var t,i,n,a,r;for(this.anyDoneList.add(e),a=this.__items,r=[],i=0,n=a.length;n>i;i++)t=a[i],"resolved"===t.state()?r.push(t.done(function(){return e.apply(null,[t].concat(o.call(arguments)))})):r.push(void 0);return r},i.prototype.onAnyFail=function(e){var t,i,n,a,r;for(this.anyFailList.add(e),a=this.__items,r=[],i=0,n=a.length;n>i;i++)t=a[i],"rejected"===t.state()?r.push(t.fail(function(){return e.apply(null,[t].concat(o.call(arguments)))})):r.push(void 0);return r},i.prototype.onAnyProgress=function(e){var i,n,a,r,o;for(this.anyProgressList.add(e),r=this.__items,o=[],n=0,a=r.length;a>n;n++)i=r[n],o.push(e(i,t(i).data("lastProgress")));return o},i.prototype.lastProgresses=function(){var e,i,n,a,r;for(a=this.__items,r=[],i=0,n=a.length;n>i;i++)e=a[i],r.push(t(e).data("lastProgress"));return r},i.prototype.add=function(e){return e&&e.then?(i.__super__.add.apply(this,arguments),this.__watchItem(e)):void 0},i.prototype.__replace=function(e,t,n){return t&&t.then?(i.__super__.__replace.apply(this,arguments),this.__watchItem(t)):this.remove(e)},i.prototype.__watchItem=function(e){var t,i=this;return t=function(t){return function(){return a.call(i.__items,e)>=0?t.fire.apply(t,[e].concat(o.call(arguments))):void 0}},e.then(t(this.anyDoneList),t(this.anyFailList),t(this.anyProgressList))},i}(e.UniqCollection)})}.call(this),function(){var t=[].slice;e.namespace("utils",function(e){var i,n;return e.log=function(){var e;return null!=(e=window.console)&&"function"==typeof e.log?e.log.apply(e,arguments):void 0},e.debug=function(){var i,n;return(null!=(i=window.console)?i.debug:void 0)?(n=window.console).debug.apply(n,arguments):e.log.apply(e,["Debug:"].concat(t.call(arguments)))},e.warn=function(){var i,n;return(null!=(i=window.console)?i.warn:void 0)?(n=window.console).warn.apply(n,arguments):e.log.apply(e,["Warning:"].concat(t.call(arguments)))},n={},e.warnOnce=function(t){return null==n[t]?(n[t]=!0,e.warn(t)):void 0},i={publicKey:"Global public key not set. Uploads may not work!\nAdd this to the <head> tag to set your key:\n\n<script>\nUPLOADCARE_PUBLIC_KEY = 'your_public_key';\n</script>"},e.commonWarning=function(t){return null!=i[t]?e.warnOnce(i[t]):void 0}})}.call(this),function(){var t;t=e.jQuery,e.namespace("utils",function(e){var i,n=this;return i={},t(window).on("message",function(e){var t,n,a,r,o,l,s;t=e.originalEvent;try{a=JSON.parse(t.data)}catch(u){return}if(a.type in i){for(l=i[a.type],s=[],r=0,o=l.length;o>r;r++)n=l[r],t.source===n[0]?s.push(n[1](a)):s.push(void 0);return s}}),e.registerMessage=function(e,t,n){return e in i||(i[e]=[]),i[e].push([t,n])},e.unregisterMessage=function(e,n){return e in i?i[e]=t.grep(i[e],function(e){return e[0]!==n}):void 0}})}.call(this),function(){var t,i=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1},n=[].slice;t=e.jQuery,e.namespace("utils",function(e){var a;return e.unique=function(e){var t,n,a,r;for(n=[],a=0,r=e.length;r>a;a++)t=e[a],i.call(n,t)<0&&n.push(t);return n},e.imageLoader=function(e){var i;return i=t.Deferred(),t(new Image).on("load",i.resolve).on("error",i.reject).attr("src",e),i.promise()},e.defer=function(e){return setTimeout(e,0)},e.gcd=function(e,t){var i;while(t)i=e%t,e=t,t=i;return e},e.once=function(e){var t,i;return t=!1,i=null,function(){return t||(i=e.apply(this,arguments),t=!0),i}},e.wrapToPromise=function(e){return t.Deferred().resolve(e).promise()},e.then=function(e,i,n,a){var r,o;return o=t.Deferred(),r=function(e,t){return e&&t?function(){return t.call(this,e.apply(this,arguments))}:e||t},e.then(r(i,o.resolve),r(n,o.reject),r(a,o.notify)),o.promise()},e.bindAll=function(e,i){
var n;return n={},t.each(i,function(i,a){var r;return r=e[a],t.isFunction(r)?n[a]=function(){var t;return t=r.apply(e,arguments),t===e?n:t}:n[a]=r}),n},e.upperCase=function(e){return e.replace(/([A-Z])/g,"_$1").toUpperCase()},e.publicCallbacks=function(e){var t;return t=e.add,t.add=e.add,t.remove=e.remove,t},e.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t,i;return t=16*Math.random()|0,i="x"===e?t:3&t|8,i.toString(16)})},e.splitUrlRegex=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)\??([^\#]*)\#?(.*)$/,e.uuidRegex=/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/i,e.groupIdRegex=new RegExp(""+e.uuidRegex.source+"~[0-9]+","i"),e.cdnUrlRegex=new RegExp("^/?("+e.uuidRegex.source+")(?:/(-/(?:[^/]+/)+)?([^/]*))?$","i"),e.splitCdnUrl=function(t){return e.cdnUrlRegex.exec(e.splitUrlRegex.exec(t)[3])},e.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},e.globRegexp=function(i,n){var a;return null==n&&(n="i"),a=t.map(i.split("*"),e.escapeRegExp),new RegExp("^"+a.join(".+")+"$",n)},e.normalizeUrl=function(e){var t;return t=document.location.protocol,"http:"!==t&&(t="https:"),e.replace(/^\/\//,t+"//").replace(/\/+$/,"")},e.fitText=function(e,t){var i,n;return e.length>t?(i=Math.ceil((t-3)/2),n=Math.floor((t-3)/2),e.slice(0,i)+"..."+e.slice(-n)):e},e.fitSizeInCdnLimit=function(t){return e.fitSize(t,[2048,2048])},e.fitSize=function(e,t,i){var n,a;return e[0]>t[0]||e[1]>t[1]||i?(a=t[0]/e[0],n=t[1]/e[1],!t[0]||t[1]&&a>n?[Math.round(n*e[0]),t[1]]:[t[0],Math.round(a*e[1])]):e.slice()},e.applyCropSelectionToFile=function(e,t,i,n){var a,r,o,l,s,u,c,d=this;return u=n.width,r=n.height,l=t.preferedSize,o="",c=u===i[0]&&r===i[1],c||(o+="-/crop/"+u+"x"+r+"/"+n.left+","+n.top+"/"),a=t.downscale&&(u>l[0]||r>l[1]),s=t.upscale&&(u<l[0]||r<l[1]),a||s?(n.sw=l[0],n.sh=l[1],o+="-/resize/"+l.join("x")+"/"):c||(o+="-/preview/"),e.then(function(e){return e.cdnUrlModifiers=o,e.cdnUrl=""+e.originalUrl+(o||""),e.crop=n,e})},e.fileInput=function(e,i,n){var a,r,o;return r=null,a=i.inputAcceptTypes,""===a&&(a=i.imagesOnly?"image/*":null),(o=function(){return r=t(i.multiple?'<input type="file" multiple>':'<input type="file">').attr("accept",a).css({position:"absolute",top:0,opacity:0,margin:0,padding:0,width:"auto",height:"auto",cursor:e.css("cursor")}).on("change",function(){return n(this),t(this).hide(),o()}),e.append(r)})(),e.css({position:"relative",overflow:"hidden"}).mousemove(function(e){var i,n,a,o;return o=t(this).offset(),i=o.left,n=o.top,a=r.width(),r.css({left:e.pageX-i-a+10,top:e.pageY-n-10})})},e.fileSelectDialog=function(e,i,n){var a;return a=i.inputAcceptTypes,""===a&&(a=i.imagesOnly?"image/*":null),t(i.multiple?'<input type="file" multiple>':'<input type="file">').attr("accept",a).css({position:"fixed",bottom:0,opacity:0}).on("change",function(){return n(this),t(this).remove()}).appendTo(e).focus().click().hide()},e.fileSizeLabels="B KB MB GB TB PB EB ZB YB".split(" "),e.readableFileSize=function(t,i,n,a){var r,o,l,s;if(null==i&&(i=""),null==n&&(n=""),null==a&&(a=""),t=parseInt(t,10),isNaN(t))return i;r=2,l=0,s=1e3-5*Math.pow(10,2-Math.max(r,3));while(t>s&&l<e.fileSizeLabels.length-1)l++,t/=1024;return t+=1e-15,o=Math.max(0,r-Math.floor(t).toFixed(0).length),t=Number(t.toFixed(o)),""+n+t+" "+e.fileSizeLabels[l]+a},e.ajaxDefaults={dataType:"json",crossDomain:!0,cache:!1},e.jsonp=function(i,n,a){return t.isPlainObject(n)&&(a=n,n="GET"),t.ajax(t.extend({url:i,type:n,data:a},e.ajaxDefaults)).then(function(e){var i;return e.error?(i=e.error.content||e.error,t.Deferred().reject(i)):e},function(t,n,a){var r;return r=""+n+" ("+a+")",e.warn("JSONP unexpected error: "+r+" while loading "+i),r})},e.canvasToBlob=function(e,t,i,n){var a,r,o,l,s,u;if(HTMLCanvasElement.prototype.toBlob)return e.toBlob(n,t,i);for(o=e.toDataURL(t,i),o=o.split(","),r=atob(o[1]),a=new Uint8Array(r.length),l=s=0,u=r.length;u>s;l=s+=1)a[l]=r.charCodeAt(l);return n(new Blob([a],{type:/:(.+\/.+);/.exec(o[0])[1]}))},e.taskRunner=function(t){var i,n,a,r;return r=0,i=[],n=function(){var t;return i.length?(t=i.shift(),e.defer(function(){return t(n)})):r-=1},a=function(a){return!t||t>r?(r+=1,e.defer(function(){return a(n)})):i.push(a)}},a=[["notify","progress",2],["resolve","done",0],["reject","fail",1]],e.fixedPipe=function(){var e,i;return i=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],t.Deferred(function(n){return t.each(a,function(a,r){var o;return o=t.isFunction(e[r[2]])&&e[r[2]],i[r[1]](function(){var e;return e=o&&o.apply(this,arguments),e&&t.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this===i?n.promise():this,o?[e]:arguments)})})}).promise()}})}.call(this),function(){var i,n,a,r=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};n=e.expose,a=e.utils,i=e.jQuery,e.namespace("settings",function(o){var l,s,u,c,d,p,f,h,g,m;return s={live:!0,manualStart:!1,locale:null,localePluralize:null,localeTranslations:null,systemDialog:!1,crop:!1,previewStep:!1,imagesOnly:!1,clearable:!1,multiple:!1,multipleMax:0,multipleMin:1,multipleMaxStrict:!1,imageShrink:!1,pathValue:!0,tabs:"file camera url facebook gdrive dropbox instagram evernote flickr skydrive",preferredTypes:"",inputAcceptTypes:"",doNotStore:!1,publicKey:null,pusherKey:"79ae88bd931ea68464d9",cdnBase:"https://ucarecdn.com",urlBase:"https://upload.uploadcare.com",socialBase:"https://social.uploadcare.com",imagePreviewMaxSize:26214400,multipartMinSize:26214400,multipartPartSize:5242880,multipartMinLastPartSize:1048576,multipartConcurrency:4,multipartMaxAttempts:3,parallelDirectUploads:10,passWindowOpen:!1,scriptBase:"undefined"!=typeof t&&null!==t?t:"",debugUploads:!1},h={tabs:{all:"file camera url facebook gdrive dropbox instagram evernote flickr skydrive box vk huddle","default":s.tabs}},g=function(e){return i.isArray(e)||(e=i.trim(e),e=e?e.split(" "):[]),e},l=function(e,t){var i,n,r,o,l,s,u,c;for(l=0,u=t.length;u>l;l++){if(n=t[l],o=r=g(e[n]),h.hasOwnProperty(n))for(o=[],s=0,c=r.length;c>s;s++)i=r[s],h[n].hasOwnProperty(i)?o=o.concat(g(h[n][i])):o.push(i);e[n]=a.unique(o)}return e},m=function(e,t){var i,n,r;for(n=0,r=t.length;r>n;n++)i=t[n],null!=e[i]&&(e[i]=a.normalizeUrl(e[i]));return e},u=function(e,t){var n,a,r,o;for(r=0,o=t.length;o>r;r++)n=t[r],null!=e[n]&&(a=e[n],"string"===i.type(a)?(a=i.trim(a).toLowerCase(),e[n]=!("false"===a||"disabled"===a)):e[n]=!!a);return e},c=function(e,t){var i,n,a;for(n=0,a=t.length;a>n;n++)i=t[n],null!=e[i]&&(e[i]=parseInt(e[i]));return e},p=function(e){var t,n;return n=/^([0-9]+)([x:])([0-9]+)\s*(|upscale|minimum)$/i,t=n.exec(i.trim(e.toLowerCase()))||[],{downscale:"x"===t[2],upscale:!!t[4],notLess:"minimum"===t[4],preferedSize:t.length?[+t[1],+t[3]]:void 0}},f=function(e){var t,n,r;return t=/^([0-9]+)x([0-9]+)(?:\s+(\d{1,2}|100)%)?$/i,n=t.exec(i.trim(e.toLowerCase()))||[],n.length?(r=n[1]*n[2],r>5e6?(a.warnOnce("Shrinked size can not be larger than 5MP. "+("You have set "+n[1]+"x"+n[2]+" (")+(""+Math.ceil(r/1e3/100)/10+"MP).")),!1):{quality:n[3]?n[3]/100:void 0,size:r}):!1},d=function(e){return l(e,["tabs","preferredTypes"]),m(e,["cdnBase","socialBase","urlBase","scriptBase"]),u(e,["doNotStore","imagesOnly","multiple","clearable","pathValue","previewStep","systemDialog","debugUploads","multipleMaxStrict"]),c(e,["multipleMax","multipleMin","multipartMinSize","multipartPartSize","multipartMinLastPartSize","multipartConcurrency","multipartMaxAttempts","parallelDirectUploads"]),e.crop===!1||i.isArray(e.crop)||(/^(disabled?|false|null)$/i.test(e.crop)?e.crop=!1:i.isPlainObject(e.crop)?e.crop=[e.crop]:e.crop=i.map((""+e.crop).split(","),p)),e.imageShrink&&!i.isPlainObject(e.imageShrink)&&(e.imageShrink=f(e.imageShrink)),(e.crop||e.multiple)&&(e.previewStep=!0),a.abilities.sendFileAPI||(e.systemDialog=!1),e.validators&&(e.validators=e.validators.slice()),e},n("defaults",i.extend({allTabs:h.tabs.all},s)),o.globals=function(){var e,t,i;i={};for(e in s)t=window["UPLOADCARE_"+a.upperCase(e)],void 0!==t&&(i[e]=t);return i},o.common=a.once(function(e,t){var n;return t||(s=i.extend(s,o.globals())),n=d(i.extend(s,e||{})),
n.publicKey||a.commonWarning("publicKey"),o.waitForSettings.fire(n),n}),o.build=function(e){var t;return t=i.extend({},o.common()),i.isEmptyObject(e)||(t=d(i.extend(t,e))),t},o.waitForSettings=i.Callbacks("once memory"),o.CssCollector=function(){function e(){this.urls=[],this.styles=[]}return e.prototype.addUrl=function(e){if(!/^https?:\/\//i.test(e))throw new Error("Embedded urls should be absolute. "+e);return r.call(this.urls,e)>=0?void 0:this.urls.push(e)},e.prototype.addStyle=function(e){return this.styles.push(e)},e}(),e.tabsCss=new o.CssCollector,s._emptyKeyText='<div class="uploadcare-dialog-message-center">\n<div class="uploadcare-dialog-big-title">Hello!</div>\n<div class="uploadcare-dialog-large-text">\n  <div>Your <a class="uploadcare-link" href="https://uploadcare.com/dashboard/">public key</a> is not set.</div>\n  <div>Add this to the &lt;head&gt; tag to start uploading files:</div>\n  <div class="uploadcare-pre">&lt;script&gt;\nUPLOADCARE_PUBLIC_KEY = \'your_public_key\';\n&lt;/script&gt;</div>\n</div>\n</div>'})}.call(this),function(){e.namespace("locale.translations",function(e){return e.en={uploading:"Uploading... Please wait.",loadingInfo:"Loading info...",errors:{"default":"Error",baddata:"Incorrect value",size:"File too big",upload:"Can’t upload",user:"Upload canceled",info:"Can’t load info",image:"Only images allowed",createGroup:"Can’t create file group",deleted:"File was deleted"},draghere:"Drop a file here",file:{one:"%1 file",other:"%1 files"},buttons:{cancel:"Cancel",remove:"Remove",choose:{files:{one:"Choose a file",other:"Choose files"},images:{one:"Choose an image",other:"Choose images"}}},dialog:{done:"Done",showFiles:"Show files",tabs:{names:{"empty-pubkey":"Welcome",preview:"Preview",file:"Local Files",url:"Arbitrary Links",camera:"Camera",facebook:"Facebook",dropbox:"Dropbox",gdrive:"Google Drive",instagram:"Instagram",vk:"VK",evernote:"Evernote",box:"Box",skydrive:"OneDrive",flickr:"Flickr",huddle:"Huddle"},file:{drag:"Drop a file here",nodrop:"Upload files from your computer",cloudsTip:"Cloud storages<br>and social networks",or:"or",button:"Choose a local file",also:"You can also choose it from"},url:{title:"Files from the Web",line1:"Grab any file off the web.",line2:"Just provide the link.",input:"Paste your link here...",button:"Upload"},camera:{capture:"Take a photo",mirror:"Mirror",startRecord:"Record a video",stopRecord:"Stop",cancelRecord:"Cancel",retry:"Request permissions again",pleaseAllow:{title:"Please allow access to your camera",text:"You have been prompted to allow camera access from this site. In order to take pictures with your camera you must approve this request."},notFound:{title:"No camera detected",text:"Looks like you have no camera connected to this device."}},preview:{unknownName:"unknown",change:"Cancel",back:"Back",done:"Add",unknown:{title:"Uploading... Please wait for a preview.",done:"Skip preview and accept"},regular:{title:"Add this file?",line1:"You are about to add the file above.",line2:"Please confirm."},image:{title:"Add this image?",change:"Cancel"},crop:{title:"Crop and add this image",done:"Done",free:"free"},error:{"default":{title:"Oops!",text:"Something went wrong during the upload.",back:"Please try again"},image:{title:"Only image files are accepted.",text:"Please try again with another file.",back:"Choose image"},size:{title:"The file you selected exceeds the limit.",text:"Please try again with another file."},loadImage:{title:"Error",text:"Can’t load image"}},multiple:{title:"You’ve chosen %files%",question:"Do you want to add all of these files?",tooManyFiles:"You’ve chosen too many files. %max% is maximum.",tooFewFiles:"You’ve chosen %files%. At least %min% required.",clear:"Remove all",done:"Done"}}},footer:{text:"powered by",link:"uploadcare"}}}}),e.namespace("locale.pluralize",function(e){return e.en=function(e){return 1===e?"one":"other"}})}.call(this),function(){var t,i,n;n=e.utils,i=e.settings,t=e.jQuery,e.namespace("locale",function(e){var a,r,o,l,s;return r="en",o={lang:r,translations:e.translations[r],pluralize:e.pluralize[r]},s=function(i){var n,a,r;return n=i.locale||o.lang,r=t.extend(!0,{},e.translations[n],i.localeTranslations),a=t.isFunction(i.localePluralize)?i.localePluralize:e.pluralize[n],{lang:n,translations:r,pluralize:a}},a=n.once(function(){return s(i.build())}),e.rebuild=function(e){var t;return t=s(i.build(e)),a=function(){return t}},l=function(e,t){var i,n,a,r;for(i=e.split("."),a=0,r=i.length;r>a;a++){if(n=i[a],null==t)return null;t=t[n]}return t},e.t=function(e,t){var i,n,r;return i=a(),n=l(e,i.translations),null==n&&i.lang!==o.lang&&(i=o,n=l(e,i.translations)),null!=t&&(n=null!=i.pluralize?(null!=(r=n[i.pluralize(t)])?r.replace("%1",t):void 0)||t:""),n||""}})}.call(this),function(){var t,i,n,a,r=function(e,t){return function(){return e.apply(t,arguments)}},o=[].slice;i=e.namespace,n=e.settings,t=e.jQuery,a=e.utils,i("files",function(e){return e.BaseFile=function(){function e(e,i,n){var a;this.settings=i,this.sourceInfo=null!=n?n:{},this.__extendApi=r(this.__extendApi,this),this.__cancel=r(this.__cancel,this),this.__resolveApi=r(this.__resolveApi,this),this.__rejectApi=r(this.__rejectApi,this),this.__runValidators=r(this.__runValidators,this),this.__fileInfo=r(this.__fileInfo,this),this.__handleFileData=r(this.__handleFileData,this),this.__updateInfo=r(this.__updateInfo,this),this.__completeUpload=r(this.__completeUpload,this),this.fileId=null,this.fileName=null,this.sanitizedName=null,this.fileSize=null,this.isStored=null,this.cdnUrlModifiers=null,this.isImage=null,this.imageInfo=null,this.mimeType=null,this.s3Bucket=null,(a=this.sourceInfo).source||(a.source=this.sourceName),this.onInfoReady=t.Callbacks("once memory"),this.__setupValidation(),this.__initApi()}return e.prototype.__startUpload=function(){return t.Deferred().resolve()},e.prototype.__completeUpload=function(){var e,t,i,n,r=this;return i=0,this.settings.debugUploads&&(a.debug("Load file info.",this.fileId,this.settings.publicKey),t=setInterval(function(){return a.debug("Still waiting for file ready.",i,r.fileId,r.settings.publicKey)},5e3),this.apiDeferred.done(function(){return a.debug("File uploaded.",i,r.fileId,r.settings.publicKey)}).always(function(){return clearInterval(t)})),n=100,(e=function(){return"pending"===r.apiDeferred.state()?(i+=1,r.__updateInfo().done(function(){return setTimeout(e,n),n+=50})):void 0})()},e.prototype.__updateInfo=function(){var e=this;return a.jsonp(""+this.settings.urlBase+"/info/",{jsonerrors:1,file_id:this.fileId,pub_key:this.settings.publicKey,wait_is_ready:+this.onInfoReady.fired()}).fail(function(t){return e.settings.debugUploads&&a.log("Can't load file info. Probably removed.",e.fileId,e.settings.publicKey,t),e.__rejectApi("info")}).done(this.__handleFileData)},e.prototype.__handleFileData=function(e){return this.fileName=e.original_filename,this.sanitizedName=e.filename,this.fileSize=e.size,this.isImage=e.is_image,this.imageInfo=e.image_info,this.mimeType=e.mime_type,this.isStored=e.is_stored,this.s3Bucket=e.s3_bucket,e.default_effects&&(this.cdnUrlModifiers="-/"+e.default_effects),this.s3Bucket&&this.cdnUrlModifiers&&this.__rejectApi("baddata"),this.onInfoReady.fired()||this.onInfoReady.fire(this.__fileInfo()),e.is_ready?this.__resolveApi():void 0},e.prototype.__progressInfo=function(){var e;return{state:this.__progressState,uploadProgress:this.__progress,progress:"ready"===(e=this.__progressState)||"error"===e?1:.9*this.__progress,incompleteFileInfo:this.__fileInfo()}},e.prototype.__fileInfo=function(){var e;return e=this.s3Bucket?"https://"+this.s3Bucket+".s3.amazonaws.com/"+this.fileId+"/"+this.sanitizedName:""+this.settings.cdnBase+"/"+this.fileId+"/",{uuid:this.fileId,name:this.fileName,size:this.fileSize,isStored:this.isStored,isImage:!this.s3Bucket&&this.isImage,originalImageInfo:this.imageInfo,mimeType:this.mimeType,originalUrl:this.fileId?e:null,cdnUrl:this.fileId?""+e+(this.cdnUrlModifiers||""):null,cdnUrlModifiers:this.cdnUrlModifiers,sourceInfo:this.sourceInfo}},e.prototype.__setupValidation=function(){return this.validators=this.settings.validators||this.settings.__validators||[],this.settings.imagesOnly&&this.validators.push(function(e){
if(e.isImage===!1)throw new Error("image")}),this.onInfoReady.add(this.__runValidators)},e.prototype.__runValidators=function(e){var t,i,n,a,r,o;e=e||this.__fileInfo();try{for(r=this.validators,o=[],n=0,a=r.length;a>n;n++)i=r[n],o.push(i(e));return o}catch(l){return t=l,this.__rejectApi(t.message)}},e.prototype.__initApi=function(){return this.apiDeferred=t.Deferred(),this.__progressState="uploading",this.__progress=0,this.__notifyApi()},e.prototype.__notifyApi=function(){return this.apiDeferred.notify(this.__progressInfo())},e.prototype.__rejectApi=function(e){return this.__progressState="error",this.__notifyApi(),this.apiDeferred.reject(e,this.__fileInfo())},e.prototype.__resolveApi=function(){return this.__progressState="ready",this.__notifyApi(),this.apiDeferred.resolve(this.__fileInfo())},e.prototype.__cancel=function(){return this.__rejectApi("user")},e.prototype.__extendApi=function(e){var t=this;return e.cancel=this.__cancel,e.pipe=e.then=function(){return t.__extendApi(a.fixedPipe.apply(a,[e].concat(o.call(arguments))))},e},e.prototype.promise=function(){var e,t=this;return this.__apiPromise||(this.__apiPromise=this.__extendApi(this.apiDeferred.promise()),this.__runValidators(),"pending"===this.apiDeferred.state()&&(e=this.__startUpload(),e.done(function(){return t.__progressState="uploaded",t.__progress=1,t.__notifyApi(),t.__completeUpload()}),e.progress(function(e){return e>t.__progress?(t.__progress=e,t.__notifyApi()):void 0}),e.fail(function(){return t.__rejectApi("upload")}),this.apiDeferred.always(e.reject))),this.__apiPromise},e}()}),i("utils",function(t){return t.isFile=function(e){return e&&e.done&&e.fail&&e.cancel},t.valueToFile=function(i,n){return i&&!t.isFile(i)&&(i=e.fileFrom("uploaded",i,n)),i||null}})}.call(this),function(){var t,i,n,a,r,o,l;t=e.jQuery,r=e.utils,o=e.utils,l=o.abilities,i=l.Blob,n=l.FileReader,a=l.URL,e.namespace("utils.image",function(e){var o,l;return o=window.DataView,l=r.taskRunner(1),e.shrinkFile=function(n,s){var u,c=this;return u=t.Deferred(),a&&o&&i?(l(function(t){var i;return u.always(t),i=r.imageLoader(a.createObjectURL(n)),i.always(function(e){return a.revokeObjectURL(e.target.src)}),i.fail(function(){return u.reject("not image")}),i.done(function(t){return u.notify(.1),e.getExif(n).always(function(n){var a;return u.notify(.2),a="resolved"===this.state(),i=e.shrinkImage(t.target,s),i.progress(function(e){return u.notify(.2+.6*e)}),i.fail(u.reject),i.done(function(t){var o,l;return o="image/jpeg",l=s.quality||.8,!a&&e.hasTransparency(t)&&(o="image/png",l=void 0),r.canvasToBlob(t,o,l,function(a){return t.width=t.height=1,u.notify(.9),n?(i=e.replaceJpegChunk(a,225,[n.buffer]),i.done(u.resolve),i.fail(function(){return u.resolve(a)})):u.resolve(a)})}),t=null})})}),u.promise()):u.reject("support")},e.shrinkImage=function(e,i){var n,a,o,l,s,u,c,d,p,f,h;return n=t.Deferred(),f=.71,e.width*f*e.height*f<i.size?n.reject("not required"):(p=s=e.width,d=e.height,u=p/d,h=Math.floor(Math.sqrt(i.size*u)),a=Math.floor(i.size/Math.sqrt(i.size*u)),l=5e6,o=4096,(c=function(){return h>=p?void n.resolve(e):r.defer(function(){var t;return p=Math.round(p*f),d=Math.round(d*f),h>p*f&&(p=h,d=a),p*d>l&&(p=Math.floor(Math.sqrt(l*u)),d=Math.floor(l/Math.sqrt(l*u))),p>o&&(p=o,d=Math.round(p/u)),d>o&&(d=o,p=Math.round(u*d)),t=document.createElement("canvas"),t.width=p,t.height=d,t.getContext("2d").drawImage(e,0,0,p,d),e.src="//:0",e.width=e.height=1,e=t,n.notify((s-p)/(s-h)),c()})})(),n.promise())},e.drawFileToCanvas=function(i,n,o,l,s){var u,c;return u=t.Deferred(),a?(c=r.imageLoader(a.createObjectURL(i)),c.always(function(e){return a.revokeObjectURL(e.target.src)}),c.fail(function(){return u.reject("not image")}),c.done(function(t){var a;return a=t.target,u.always(function(){return a.src="//:0"}),s&&a.width*a.height>s?u.reject("max source"):e.getExif(i).always(function(t){var i,s,c,d,p,f,h,g,m,v;return p=e.parseExifOrientation(t)||1,h=p>4,f=h?[a.height,a.width]:[a.width,a.height],m=r.fitSize(f,[n,o]),d=m[0],c=m[1],(g=[[1,0,0,1,0,0],[-1,0,0,1,d,0],[-1,0,0,-1,d,c],[1,0,0,-1,0,c],[0,1,1,0,0,0],[0,1,-1,0,d,0],[0,-1,-1,0,d,c],[0,-1,1,0,0,c]][p-1])?(i=document.createElement("canvas"),i.width=d,i.height=c,s=i.getContext("2d"),s.transform.apply(s,g),h&&(v=[c,d],d=v[0],c=v[1]),l&&(s.fillStyle=l,s.fillRect(0,0,d,c)),s.drawImage(a,0,0,d,c),u.resolve(i,f)):u.reject("bad image")})}),u.promise()):u.reject("support")},e.readJpegChunks=function(e){var i,a,r,l,s;return s=function(e,t){var a;return a=new n,a.onload=function(){return t(new o(a.result))},a.onerror=function(e){return i.reject("reader",e)},a.readAsArrayBuffer(e)},r=function(){return s(e.slice(a,a+128),function(e){var t,i,n;for(t=i=0,n=e.byteLength;n>=0?n>i:i>n;t=n>=0?++i:--i)if(255===e.getUint8(t)){a+=t;break}return l()})},l=function(){var t;return t=a,s(e.slice(a,a+=4),function(n){var o,l;return 4!==n.byteLength||255!==n.getUint8(0)?i.reject("corrupted"):(l=n.getUint8(1),218===l?i.resolve():(o=n.getUint16(2)-2,s(e.slice(a,a+=o),function(e){return e.byteLength!==o?i.reject("corrupted"):(i.notify(t,o,l,e),r())})))})},i=t.Deferred(),n&&o?(a=2,s(e.slice(0,2),function(e){return 65496!==e.getUint16(0)?i.reject("not jpeg"):r()}),i.promise()):i.reject("support")},e.replaceJpegChunk=function(n,a,r){var l,s,u,c;return l=t.Deferred(),u=[],s=[],c=e.readJpegChunks(n),c.fail(l.reject),c.progress(function(e,t,i){return i===a?(u.push(e),s.push(t)):void 0}),c.done(function(){var e,t,c,d,p,f,h,g,m;for(d=[n.slice(0,2)],f=0,g=r.length;g>f;f++)e=r[f],c=new o(new ArrayBuffer(4)),c.setUint16(0,65280+a),c.setUint16(2,e.byteLength+2),d.push(c.buffer),d.push(e);for(p=2,t=h=0,m=u.length;m>=0?m>h:h>m;t=m>=0?++h:--h)u[t]>p&&d.push(n.slice(p,u[t])),p=u[t]+s[t]+4;return d.push(n.slice(p,n.size)),l.resolve(new i(d,{type:n.type}))}),l.promise()},e.getExif=function(i){var n,a;return n=null,a=e.readJpegChunks(i),a.progress(function(e,t,i,a){return!n&&225===i&&a.byteLength>=14&&1165519206===a.getUint32(0)&&0===a.getUint16(4)?n=a:void 0}),a.then(function(){return n},function(e){return t.Deferred().reject(n,e)})},e.parseExifOrientation=function(e){var t,i,n,a,r;if(!e||e.byteLength<14||1165519206!==e.getUint32(0)||0!==e.getUint16(4)||42!==e.getUint16(8))return null;if(18761===e.getUint16(6))n=!0;else{if(19789!==e.getUint16(6))return null;n=!1}for(a=8+e.getUint32(10,n),t=e.getUint16(a-2,n),i=r=0;t>=0?t>r:r>t;i=t>=0?++r:--r){if(e.byteLength<a+10)return null;if(274===e.getUint16(a,n))return e.getUint16(a+8,n);a+=12}return null},e.hasTransparency=function(e){var t,i,n,a,r,o,l;for(r=50,t=document.createElement("canvas"),t.width=t.height=r,i=t.getContext("2d"),i.drawImage(e,0,0,r,r),n=i.getImageData(0,0,r,r).data,t.width=t.height=1,a=o=3,l=n.length;l>o;a=o+=4)if(n[a]<254)return!0;return!1}})}.call(this),function(){var t,i,n=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,r=function(e,t){for(var i in t)a.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};t=e.jQuery,i=e.utils,e.namespace("files",function(e){return e.ObjectFile=function(e){var a;r(o,e),a=null,o.prototype.sourceName="local";function o(e){this.__file=e,this.setFile=n(this.setFile,this),o.__super__.constructor.apply(this,arguments),this.fileName=this.__file.name||"original",this.__notifyApi()}return o.prototype.setFile=function(e){return e&&(this.__file=e),this.sourceInfo.file=this.__file,this.__file?(this.fileSize=this.__file.size,this.fileType=this.__file.type||"application/octet-stream",this.settings.debugUploads&&i.debug("Use local file.",this.fileName,this.fileType,this.fileSize),this.__runValidators(),this.__notifyApi()):void 0},o.prototype.__startUpload=function(){var e,n,a,r=this;return this.apiDeferred.always(function(){return r.__file=null}),this.__file.size>=this.settings.multipartMinSize&&i.abilities.Blob?(this.setFile(),this.multipartUpload()):(n=i.abilities.iOSVersion,!this.settings.imageShrink||n&&8>n?(this.setFile(),this.directUpload()):(e=t.Deferred(),a=.4,i.image.shrinkFile(this.__file,this.settings.imageShrink).progress(function(t){return e.notify(t*a)}).done(this.setFile).fail(function(){return r.setFile(),a=.1*a}).always(function(){
return e.notify(a),r.directUpload().done(e.resolve).fail(e.reject).progress(function(t){return e.notify(a+t*(1-a))})}),e))},o.prototype.__autoAbort=function(e){return this.apiDeferred.fail(e.abort),e},o.prototype.directRunner=function(e){return a||(a=i.taskRunner(this.settings.parallelDirectUploads)),a(e)},o.prototype.directUpload=function(){var e,i=this;return e=t.Deferred(),this.__file?this.fileSize>104857600?(this.__rejectApi("size"),e):(this.directRunner(function(n){var a;return e.always(n),"pending"===i.apiDeferred.state()?(a=new FormData,a.append("UPLOADCARE_PUB_KEY",i.settings.publicKey),a.append("UPLOADCARE_STORE",i.settings.doNotStore?"":"auto"),a.append("file",i.__file,i.fileName),a.append("file_name",i.fileName),a.append("source",i.sourceInfo.source),i.__autoAbort(t.ajax({xhr:function(){var i;return i=t.ajaxSettings.xhr(),i.upload&&i.upload.addEventListener("progress",function(t){return e.notify(t.loaded/t.total)},!1),i},crossDomain:!0,type:"POST",url:""+i.settings.urlBase+"/base/?jsonerrors=1",headers:{"X-PINGOTHER":"pingpong"},contentType:!1,processData:!1,data:a,dataType:"json",error:e.reject,success:function(t){return(null!=t?t.file:void 0)?(i.fileId=t.file,e.resolve()):e.reject()}}))):void 0}),e):(this.__rejectApi("baddata"),e)},o.prototype.multipartUpload=function(){var e,i=this;return e=t.Deferred(),this.__file?this.settings.imagesOnly?(this.__rejectApi("image"),e):(this.multipartStart().done(function(t){return i.uploadParts(t.parts,t.uuid).done(function(){return i.multipartComplete(t.uuid).done(function(t){return i.fileId=t.uuid,i.__handleFileData(t),e.resolve()}).fail(e.reject)}).progress(e.notify).fail(e.reject)}).fail(e.reject),e):e},o.prototype.multipartStart=function(){var e,t=this;return e={UPLOADCARE_PUB_KEY:this.settings.publicKey,filename:this.fileName,source:this.sourceInfo.source,size:this.fileSize,content_type:this.fileType,part_size:this.settings.multipartPartSize,UPLOADCARE_STORE:this.settings.doNotStore?"":"auto"},this.__autoAbort(i.jsonp(""+this.settings.urlBase+"/multipart/start/?jsonerrors=1","POST",e).fail(function(n){return t.settings.debugUploads?i.log("Can't start multipart upload.",n,e):void 0}))},o.prototype.uploadParts=function(e,n){var a,r,o,l,s,u,c,d,p,f,h,g=this;for(s=[],l=t.now(),p=function(e,i){var n,r,o;if(s[e]=i,!(t.now()-l<250)){for(l=t.now(),n=0,r=0,o=s.length;o>r;r++)i=s[r],n+=i;return a.notify(n/g.fileSize)}},a=t.Deferred(),o=0,d=0,c=0,u=function(){var r,l,f,h,m;if(!(c>=g.fileSize))return f=c+g.settings.multipartPartSize,g.fileSize<f+g.settings.multipartMinLastPartSize&&(f=g.fileSize),l=g.__file.slice(c,f),c=f,h=d,o+=1,d+=1,r=0,(m=function(){return"pending"===g.apiDeferred.state()?(s[h]=0,g.__autoAbort(t.ajax({xhr:function(){var e;return e=t.ajaxSettings.xhr(),e.upload&&e.upload.addEventListener("progress",function(e){return p(h,e.loaded)},!1),e},url:e[h],crossDomain:!0,type:"PUT",processData:!1,contentType:g.fileType,data:l,error:function(){return r+=1,r>g.settings.multipartMaxAttempts?(g.settings.debugUploads&&i.info("Part #"+h+" and file upload is failed.",n),a.reject()):(g.settings.debugUploads&&i.debug("Part #"+h+"("+r+") upload is failed.",n),m())},success:function(){return o-=1,u(),o?void 0:a.resolve()}}))):void 0})()},r=f=0,h=this.settings.multipartConcurrency;h>=0?h>f:f>h;r=h>=0?++f:--f)u();return a},o.prototype.multipartComplete=function(e){var t,n=this;return t={UPLOADCARE_PUB_KEY:this.settings.publicKey,uuid:e},this.__autoAbort(i.jsonp(""+this.settings.urlBase+"/multipart/complete/?jsonerrors=1","POST",t).fail(function(t){return n.settings.debugUploads?i.log("Can't complete multipart upload.",e,n.settings.publicKey,t):void 0}))},o}(e.BaseFile)})}.call(this),function(){var t,i,n=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,r=function(e,t){for(var i in t)a.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};t=e.jQuery,i=e.utils,e.namespace("files",function(e){return e.InputFile=function(e){r(a,e),a.prototype.sourceName="local-compat";function a(e){this.__input=e,this.__cleanUp=n(this.__cleanUp,this),a.__super__.constructor.apply(this,arguments),this.fileId=i.uuid(),this.fileName=t(this.__input).val().split("\\").pop(),this.__notifyApi()}return a.prototype.__startUpload=function(){var e,i,n,a;return e=t.Deferred(),a=""+this.settings.urlBase+"/iframe/",n="uploadcare-iframe-"+this.fileId,this.__iframe=t("<iframe>").attr({id:n,name:n}).css("display","none").appendTo("body").on("load",e.resolve).on("error",e.reject),i=function(e,i){return t("<input/>",{type:"hidden",name:e,value:i})},t(this.__input).attr("name","file"),this.__iframeForm=t("<form>").attr({method:"POST",action:a,enctype:"multipart/form-data",target:n}).append(i("UPLOADCARE_PUB_KEY",this.settings.publicKey)).append(i("UPLOADCARE_FILE_ID",this.fileId)).append(i("UPLOADCARE_STORE",this.settings.doNotStore?"":"auto")).append(i("UPLOADCARE_SOURCE",this.sourceInfo.source)).append(this.__input).css("display","none").appendTo("body").submit(),e.always(this.__cleanUp)},a.prototype.__cleanUp=function(){var e,t;return null!=(e=this.__iframe)&&e.off("load error").remove(),null!=(t=this.__iframeForm)&&t.remove(),this.__iframe=null,this.__iframeForm=null},a}(e.BaseFile)})}.call(this),function(){var e,t;!function(){void 0===Function.prototype.scopedTo&&(Function.prototype.scopedTo=function(e,t){var i=this;return function(){return i.apply(e,Array.prototype.slice.call(t||[]).concat(Array.prototype.slice.call(arguments)))}}),e=function(t,i){this.options=i||{},this.key=t,this.channels=new e.Channels,this.global_emitter=new e.EventsDispatcher;var n=this;this.checkAppKey(),this.connection=new e.Connection(this.key,this.options),this.connection.bind("connected",function(){n.subscribeAll()}).bind("message",function(e){var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var i;(i=n.channel(e.channel))&&i.emit(e.event,e.data)}t||n.global_emitter.emit(e.event,e.data)}).bind("disconnected",function(){n.channels.disconnect()}).bind("error",function(t){e.warn("Error",t)}),e.instances.push(this),e.isReady&&n.connect()},e.instances=[],e.prototype={channel:function(e){return this.channels.find(e)},connect:function(){this.connection.connect()},disconnect:function(){this.connection.disconnect()},bind:function(e,t){return this.global_emitter.bind(e,t),this},bind_all:function(e){return this.global_emitter.bind_all(e),this},subscribeAll:function(){var e;for(channelName in this.channels.channels)this.channels.channels.hasOwnProperty(channelName)&&this.subscribe(channelName)},subscribe:function(e){var t=this,i=this.channels.add(e,this);return"connected"===this.connection.state&&i.authorize(this.connection.socket_id,this.options,function(n,a){n?i.emit("pusher:subscription_error",a):t.send_event("pusher:subscribe",{channel:e,auth:a.auth,channel_data:a.channel_data})}),i},unsubscribe:function(e){this.channels.remove(e),"connected"===this.connection.state&&this.send_event("pusher:unsubscribe",{channel:e})},send_event:function(e,t,i){return this.connection.send_event(e,t,i)},checkAppKey:function(){(null===this.key||void 0===this.key)&&e.warn("Warning","You must pass your app key when you instantiate Pusher.")}},e.Util={extend:function t(e,i){for(var n in i)i[n]&&i[n].constructor&&i[n].constructor===Object?e[n]=t(e[n]||{},i[n]):e[n]=i[n];return e},stringify:function n(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"==typeof arguments[t]?e.push(arguments[t]):void 0==window.JSON?e.push(arguments[t].toString()):e.push(JSON.stringify(arguments[t]));return e.join(" : ")},arrayIndexOf:function(e,t){var n=Array.prototype.indexOf;if(null==e)return-1;if(n&&e.indexOf===n)return e.indexOf(t);for(i=0,l=e.length;i<l;i++)if(e[i]===t)return i;return-1}},e.debug=function(){e.log&&e.log(e.Util.stringify.apply(this,arguments))},e.warn=function(){if(window.console&&window.console.warn)window.console.warn(e.Util.stringify.apply(this,arguments));else{if(!e.log)return;e.log(e.Util.stringify.apply(this,arguments))}},e.VERSION="1.12.2",e.host="ws.pusherapp.com",e.ws_port=80,e.wss_port=443,e.channel_auth_endpoint="/pusher/auth",e.cdn_http="http://js.pusher.com/",
e.cdn_https="https://d3dy5gmtp8yhk7.cloudfront.net/",e.dependency_suffix=".min",e.channel_auth_transport="ajax",e.activity_timeout=12e4,e.pong_timeout=3e4,e.isReady=!1,e.ready=function(){e.isReady=!0;for(var t=0,i=e.instances.length;i>t;t++)e.instances[t].connect()}}(),function(){function t(){this._callbacks={}}t.prototype.get=function(e){return this._callbacks[this._prefix(e)]},t.prototype.add=function(e,t){var i=this._prefix(e);this._callbacks[i]=this._callbacks[i]||[],this._callbacks[i].push(t)},t.prototype.remove=function(t,i){if(this.get(t)){var n=e.Util.arrayIndexOf(this.get(t),i);this._callbacks[this._prefix(t)].splice(n,1)}},t.prototype._prefix=function(e){return"_"+e};function i(e){this.callbacks=new t,this.global_callbacks=[],this.failThrough=e}i.prototype.bind=function(e,t){return this.callbacks.add(e,t),this},i.prototype.unbind=function(e,t){return this.callbacks.remove(e,t),this},i.prototype.emit=function(e,t){for(var i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](e,t);var n=this.callbacks.get(e);if(n)for(var i=0;i<n.length;i++)n[i](t);else this.failThrough&&this.failThrough(e,t);return this},i.prototype.bind_all=function(e){return this.global_callbacks.push(e),this},e.EventsDispatcher=i}(),function(){function t(e){return e.substr(0,1).toUpperCase()+e.substr(1)}function i(e,t,i){void 0!==t[e]&&t[e](i)}function n(t,i,n){e.EventsDispatcher.call(this),this.state=void 0,this.errors=[],this.stateActions=n,this.transitions=i,this.transition(t)}n.prototype.transition=function(n,a){var r=this.state,o=this.stateActions;if(r&&-1==e.Util.arrayIndexOf(this.transitions[r],n))throw this.emit("invalid_transition_attempt",{oldState:r,newState:n}),new Error("Invalid transition ["+r+" to "+n+"]");i(r+"Exit",o,a),i(r+"To"+t(n),o,a),i(n+"Pre",o,a),this.state=n,this.emit("state_change",{oldState:r,newState:n}),i(n+"Post",o,a)},n.prototype.is=function(e){return this.state===e},n.prototype.isNot=function(e){return this.state!==e},e.Util.extend(n.prototype,e.EventsDispatcher.prototype),e.Machine=n}(),function(){var t=function(){var t=this;e.EventsDispatcher.call(this),void 0!==window.addEventListener&&(window.addEventListener("online",function(){t.emit("online",null)},!1),window.addEventListener("offline",function(){t.emit("offline",null)},!1))};t.prototype.isOnLine=function(){return void 0===window.navigator.onLine?!0:window.navigator.onLine},e.Util.extend(t.prototype,e.EventsDispatcher.prototype),e.NetInfo=t}(),function(){var t={initialized:["waiting","failed"],waiting:["connecting","permanentlyClosed"],connecting:["open","permanentlyClosing","impermanentlyClosing","waiting"],open:["connected","permanentlyClosing","impermanentlyClosing","waiting"],connected:["permanentlyClosing","waiting"],impermanentlyClosing:["waiting","permanentlyClosing"],permanentlyClosing:["permanentlyClosed"],permanentlyClosed:["waiting","failed"],failed:["permanentlyClosed"]},i=2e3,n=2e3,a=2e3,r=5*i,o=5*n,l=5*a;function s(t){t.connectionWait=0,"flash"===e.TransportType?t.openTimeout=5e3:t.openTimeout=2e3,t.connectedTimeout=2e3,t.connectionSecure=t.compulsorySecure,t.connectionAttempts=0}function u(u,c){var d=this;e.EventsDispatcher.call(this),this.options=e.Util.extend({encrypted:!1},c),this.netInfo=new e.NetInfo,this.netInfo.bind("online",function(){d._machine.is("waiting")&&(d._machine.transition("connecting"),T("connecting"))}),this.netInfo.bind("offline",function(){d._machine.is("connected")&&(d.socket.onclose=void 0,d.socket.onmessage=void 0,d.socket.onerror=void 0,d.socket.onopen=void 0,d.socket.close(),d.socket=void 0,d._machine.transition("waiting"))}),this._machine=new e.Machine("initialized",t,{initializedPre:function(){d.compulsorySecure=d.options.encrypted,d.key=u,d.socket=null,d.socket_id=null,d.state="initialized"},waitingPre:function(){d.connectionWait>0&&d.emit("connecting_in",d.connectionWait),T(d.netInfo.isOnLine()&&d.connectionAttempts<=4?"connecting":"unavailable"),d.netInfo.isOnLine()&&(d._waitingTimer=setTimeout(function(){d._machine.transition("connecting")},v()))},waitingExit:function(){clearTimeout(d._waitingTimer)},connectingPre:function(){if(d.netInfo.isOnLine()===!1)return d._machine.transition("waiting"),void T("unavailable");var t=f(d.key,d.connectionSecure);e.debug("Connecting",t),d.socket=new e.Transport(t),d.socket.onopen=b,d.socket.onclose=k,d.socket.onerror=C,d._connectingTimer=setTimeout(h,d.openTimeout)},connectingExit:function(){clearTimeout(d._connectingTimer),d.socket.onopen=void 0},connectingToWaiting:function(){p()},connectingToImpermanentlyClosing:function(){p()},openPre:function(){d.socket.onmessage=y,d.socket.onerror=C,d.socket.onclose=k,d._openTimer=setTimeout(h,d.connectedTimeout)},openExit:function(){clearTimeout(d._openTimer),d.socket.onmessage=void 0},openToWaiting:function(){p()},openToImpermanentlyClosing:function(){p()},connectedPre:function(e){d.socket_id=e,d.socket.onmessage=w,d.socket.onerror=C,d.socket.onclose=k,s(d),d.connectedAt=(new Date).getTime(),g()},connectedPost:function(){T("connected")},connectedExit:function(){m(),T("disconnected")},impermanentlyClosingPost:function(){d.socket&&(d.socket.onclose=k,d.socket.close())},permanentlyClosingPost:function(){d.socket?(d.socket.onclose=function(){s(d),d._machine.transition("permanentlyClosed")},d.socket.close()):(s(d),d._machine.transition("permanentlyClosed"))},failedPre:function(){T("failed"),e.debug("WebSockets are not available in this browser.")},permanentlyClosedPost:function(){T("disconnected")}});function p(){d.connectionWait<r&&(d.connectionWait+=i),d.openTimeout<o&&(d.openTimeout+=n),d.connectedTimeout<l&&(d.connectedTimeout+=a),d.compulsorySecure!==!0&&(d.connectionSecure=!d.connectionSecure),d.connectionAttempts++}function f(t,i){var n=e.ws_port,a="ws://";(i||"https:"===document.location.protocol)&&(n=e.wss_port,a="wss://");var r="flash"===e.TransportType?"true":"false";return a+e.host+":"+n+"/app/"+t+"?protocol=5&client=js&version="+e.VERSION+"&flash="+r}function h(){d._machine.transition("impermanentlyClosing")}function g(){d._activityTimer&&clearTimeout(d._activityTimer),d._activityTimer=setTimeout(function(){d.send_event("pusher:ping",{}),d._activityTimer=setTimeout(function(){d.socket.close()},d.options.pong_timeout||e.pong_timeout)},d.options.activity_timeout||e.activity_timeout)}function m(){d._activityTimer&&clearTimeout(d._activityTimer)}function v(){var e=d.connectionWait;if(0===e&&d.connectedAt){var t=1e3,i=(new Date).getTime()-d.connectedAt;t>i&&(e=t-i)}return e}function b(){d._machine.transition("open")}function _(e,t){d.emit("error",{type:"PusherError",data:{code:e,message:t}}),4e3===e?(d.compulsorySecure=!0,d.connectionSecure=!0,d.options.encrypted=!0,h()):4100>e?d._machine.transition("permanentlyClosing"):4200>e?(d.connectionWait=1e3,d._machine.transition("waiting")):4300>e?h():d._machine.transition("permanentlyClosing")}function y(e){var t=x(e);void 0!==t&&("pusher:connection_established"===t.event?d._machine.transition("connected",t.data.socket_id):"pusher:error"===t.event&&_(t.data.code,t.data.message))}function w(t){g();var i=x(t);if(void 0!==i){switch(e.debug("Event recd",i),i.event){case"pusher:error":d.emit("error",{type:"PusherError",data:i.data});break;case"pusher:ping":d.send_event("pusher:pong",{})}d.emit("message",i)}}function x(e){try{var t=JSON.parse(e.data);if("string"==typeof t.data)try{t.data=JSON.parse(t.data)}catch(i){if(!(i instanceof SyntaxError))throw i}return t}catch(i){d.emit("error",{type:"MessageParseError",error:i,data:e.data})}}function k(){d._machine.transition("waiting")}function C(e){d.emit("error",{type:"WebSocketError",error:e})}function T(t,i){var n=d.state;d.state=t,n!==t&&(e.debug("State changed",n+" -> "+t),d.emit("state_change",{previous:n,current:t}),d.emit(t,i))}}u.prototype.connect=function(){this._machine.is("failed")||e.Transport?this._machine.is("initialized")?(s(this),this._machine.transition("waiting")):this._machine.is("waiting")&&this.netInfo.isOnLine()===!0?this._machine.transition("connecting"):this._machine.is("permanentlyClosed")&&(s(this),this._machine.transition("waiting")):this._machine.transition("failed")},u.prototype.send=function(e){if(this._machine.is("connected")){
var t=this;return setTimeout(function(){t.socket.send(e)},0),!0}return!1},u.prototype.send_event=function(t,i,n){var a={event:t,data:i};return n&&(a.channel=n),e.debug("Event sent",a),this.send(JSON.stringify(a))},u.prototype.disconnect=function(){this._machine.is("permanentlyClosed")||(this._machine.is("waiting")||this._machine.is("failed")?this._machine.transition("permanentlyClosed"):this._machine.transition("permanentlyClosing"))},e.Util.extend(u.prototype,e.EventsDispatcher.prototype),e.Connection=u}(),function(){e.Channels=function(){this.channels={}},e.Channels.prototype={add:function(t,i){var n=this.find(t);if(n)return n;var a=e.Channel.factory(t,i);return this.channels[t]=a,a},find:function(e){return this.channels[e]},remove:function(e){delete this.channels[e]},disconnect:function(){for(var e in this.channels)this.channels[e].disconnect()}},e.Channel=function(t,i){var n=this;e.EventsDispatcher.call(this,function(i,n){e.debug("No callbacks on "+t+" for "+i)}),this.pusher=i,this.name=t,this.subscribed=!1,this.bind("pusher_internal:subscription_succeeded",function(e){n.onSubscriptionSucceeded(e)})},e.Channel.prototype={init:function(){},disconnect:function(){this.subscribed=!1,this.emit("pusher_internal:disconnected")},onSubscriptionSucceeded:function(e){this.subscribed=!0,this.emit("pusher:subscription_succeeded")},authorize:function(e,t,i){return i(!1,{})},trigger:function(e,t){return this.pusher.send_event(e,t,this.name)}},e.Util.extend(e.Channel.prototype,e.EventsDispatcher.prototype),e.Channel.PrivateChannel={authorize:function(t,i,n){var a=this,r=new e.Channel.Authorizer(this,e.channel_auth_transport,i);return r.authorize(t,function(e,t){e||a.emit("pusher_internal:authorized",t),n(e,t)})}},e.Channel.PresenceChannel={init:function(){this.members=new t(this)},onSubscriptionSucceeded:function(e){this.subscribed=!0}};var t=function(e){var t=this,i=function(){this._members_map={},this.count=0,this.me=null};i.call(this),e.bind("pusher_internal:authorized",function(i){var n=JSON.parse(i.channel_data);e.bind("pusher_internal:subscription_succeeded",function(i){t._members_map=i.presence.hash,t.count=i.presence.count,t.me=t.get(n.user_id),e.emit("pusher:subscription_succeeded",t)})}),e.bind("pusher_internal:member_added",function(i){null===t.get(i.user_id)&&t.count++,t._members_map[i.user_id]=i.user_info,e.emit("pusher:member_added",t.get(i.user_id))}),e.bind("pusher_internal:member_removed",function(i){var n=t.get(i.user_id);n&&(delete t._members_map[i.user_id],t.count--,e.emit("pusher:member_removed",n))}),e.bind("pusher_internal:disconnected",function(){i.call(t)})};t.prototype={each:function(e){for(var t in this._members_map)e(this.get(t))},get:function(e){return this._members_map.hasOwnProperty(e)?{id:e,info:this._members_map[e]}:null}},e.Channel.factory=function(t,i){var n=new e.Channel(t,i);return 0===t.indexOf("private-")?e.Util.extend(n,e.Channel.PrivateChannel):0===t.indexOf("presence-")&&(e.Util.extend(n,e.Channel.PrivateChannel),e.Util.extend(n,e.Channel.PresenceChannel)),n.init(),n}}(),function(){e.Channel.Authorizer=function(e,t,i){this.channel=e,this.type=t,this.authOptions=(i||{}).auth||{}},e.Channel.Authorizer.prototype={composeQuery:function(e){var t="&socket_id="+encodeURIComponent(e)+"&channel_name="+encodeURIComponent(this.channel.name);for(var i in this.authOptions.params)t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(this.authOptions.params[i]);return t},authorize:function(t,i){return e.authorizers[this.type].call(this,t,i)}},e.auth_callbacks={},e.authorizers={ajax:function(t,i){var n=this,a;a=e.XHR?new e.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.open("POST",e.channel_auth_endpoint,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var r in this.authOptions.headers)a.setRequestHeader(r,this.authOptions.headers[r]);return a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status){var t,n=!1;try{t=JSON.parse(a.responseText),n=!0}catch(r){i(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+a.responseText)}n&&i(!1,t)}else e.warn("Couldn't get auth info from your webapp",a.status),i(!0,a.status)},a.send(this.composeQuery(t)),a},jsonp:function(t,i){void 0!==this.authOptions.headers&&e.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var n=document.createElement("script");e.auth_callbacks[this.channel.name]=function(e){i(!1,e)};var a="Pusher.auth_callbacks['"+this.channel.name+"']";n.src=e.channel_auth_endpoint+"?callback="+encodeURIComponent(a)+this.composeQuery(t);var r=document.getElementsByTagName("head")[0]||document.documentElement;r.insertBefore(n,r.firstChild)}}}();var t=function(){function e(e,t){document.addEventListener?e.addEventListener("load",t,!1):e.attachEvent("onreadystatechange",function(){("loaded"==e.readyState||"complete"==e.readyState)&&t()})}function t(t,i){var n=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("src",t),a.setAttribute("type","text/javascript"),a.setAttribute("async",!0),e(a,function(){i()}),n.appendChild(a)}return function(e,i){for(var n=0,a=0;a<e.length;a++)t(e[a],function(){e.length==++n&&setTimeout(i,0)})}}();!function(){!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),window.WebSocket&&(e.Transport=window.WebSocket,e.TransportType="native");var i="http:"==document.location.protocol?e.cdn_http:e.cdn_https,n=i+e.VERSION,a=[];window.JSON||a.push(n+"/json2"+e.dependency_suffix+".js"),window.WebSocket||(window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,a.push(n+"/flashfallback"+e.dependency_suffix+".js"));var r=function(){return window.WebSocket?function(){e.ready()}:function(){window.WebSocket?(e.Transport=window.WebSocket,e.TransportType="flash",window.WEB_SOCKET_SWF_LOCATION="https://s3.amazonaws.com/uploadcare-static/WebSocketMainInsecure.swf",WebSocket.__addTask(function(){e.ready()}),WebSocket.__initialize()):(e.Transport=null,e.TransportType="none",e.ready())}}(),o=function(e){var t=function(){document.body?e():setTimeout(t,0)};t()},l=function(){o(r)};a.length>0?t(a,l):l()}(),this.Pusher=e}.call(e),function(){var t,i={}.hasOwnProperty,n=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};t=e.jQuery,e.namespace("utils.pusher",function(i){var a,r,o;return r={},e.Pusher.prototype.constructor=e.Pusher,a=function(e){n(i,e);function i(){return o=i.__super__.constructor.apply(this,arguments)}return i.prototype.subscribe=function(e){return this.disconnectTimeout&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=null),this.connect(),i.__super__.subscribe.apply(this,arguments)},i.prototype.unsubscribe=function(e){var n=this;return i.__super__.unsubscribe.apply(this,arguments),t.isEmptyObject(this.channels.channels)?this.disconnectTimeout=setTimeout(function(){return n.disconnectTimeout=null,n.disconnect()},5e3):void 0},i}(e.Pusher),i.getPusher=function(e){return null==r[e]&&(r[e]=new a(e)),r[e].connect(),r[e]}})}.call(this),function(){var t,i,n,a=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,o=function(e,t){for(var i in t)r.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};t=e.jQuery,n=e.utils,i=e.utils.pusher,e.namespace("files",function(e){var r,l;return e.UrlFile=function(e){o(i,e),i.prototype.sourceName="url",i.prototype.allEvents="progress success error fail";function i(e){var t,r;if(this.__url=e,this.__listenWatcher=a(this.__listenWatcher,this),i.__super__.constructor.apply(this,arguments),r=n.splitUrlRegex.exec(this.__url)[3].split("/").pop())try{this.fileName=decodeURIComponent(r)}catch(o){t=o,this.fileName=r}this.__notifyApi()}return i.prototype.setName=function(e){return this.fileName=e,this.__realFileName=e,this.__notifyApi()},i.prototype.setIsImage=function(e){return this.isImage=e,this.__notifyApi()},i.prototype.__startUpload=function(){var e,i,a,o,s=this;return i=t.Deferred(),o=new l(this.settings),a=new r(this.settings),
e={pub_key:this.settings.publicKey,source_url:this.__url,filename:this.__realFileName||"",source:this.sourceInfo.source,store:this.settings.doNotStore?"":"auto",jsonerrors:1},n.defer(function(){return"pending"===s.apiDeferred.state()?n.jsonp(""+s.settings.urlBase+"/from_url/",e).fail(function(t){return s.settings.debugUploads&&n.debug("Can't start upload from URL.",t,e),i.reject()}).done(function(e){var r;if("pending"===s.apiDeferred.state())return s.settings.debugUploads&&(n.debug("Start watchers.",e.token),r=setInterval(function(){return n.debug("Still watching.",e.token)},5e3),i.done(function(){return n.debug("Stop watchers.",e.token)}).always(function(){return clearInterval(r)})),s.__listenWatcher(i,t([o,a])),i.always(function(){return t([o,a]).off(s.allEvents),o.stopWatching(),a.stopWatching()}),t(o).one(s.allEvents,function(){return a.interval?(s.settings.debugUploads&&n.debug("Start using pusher.",e.token),a.stopWatching()):void 0}),o.watch(e.token),a.watch(e.token)}):void 0}),i},i.prototype.__listenWatcher=function(e,i){var n=this;return i.on("progress",function(t,i){return n.fileSize=i.total,e.notify(i.done/i.total)}).on("success",function(i,a){return t(i.target).trigger("progress",a),n.fileId=a.uuid,n.__handleFileData(a),e.resolve()}).on("error fail",e.reject)},i}(e.BaseFile),l=function(){function e(e){this.settings=e;try{this.pusher=i.getPusher(this.settings.pusherKey)}catch(t){this.pusher=null}}return e.prototype.watch=function(e){var i,n=this;return this.token=e,this.pusher?(i=this.pusher.subscribe("task-status-"+this.token),i.bind_all(function(e,i){return t(n).trigger(e,i)})):void 0},e.prototype.stopWatching=function(){return this.pusher?this.pusher.unsubscribe("task-status-"+this.token):void 0},e}(),r=function(){function e(e){this.settings=e,this.poolUrl=""+this.settings.urlBase+"/from_url/status/"}return e.prototype.watch=function(e){var t,i=this;return this.token=e,(t=function(){return i.interval=setTimeout(function(){return i.__updateStatus().done(function(){return i.interval?t():void 0})},333)})()},e.prototype.stopWatching=function(){return this.interval&&clearTimeout(this.interval),this.interval=null},e.prototype.__updateStatus=function(){var e=this;return n.jsonp(this.poolUrl,{token:this.token}).fail(function(i){return t(e).trigger("error")}).done(function(i){return t(e).trigger(i.status,i)})},e}()})}.call(this),function(){var t,i,n={}.hasOwnProperty,a=function(e,t){for(var i in t)n.call(t,i)&&(e[i]=t[i]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};t=e.jQuery,i=e.utils,e.namespace("files",function(e){return e.UploadedFile=function(e){a(t,e),t.prototype.sourceName="uploaded";function t(e){var n;t.__super__.constructor.apply(this,arguments),n=i.splitCdnUrl(e),n?(this.fileId=n[1],n[2]&&(this.cdnUrlModifiers=n[2])):this.__rejectApi("baddata")}return t}(e.BaseFile),e.ReadyFile=function(e){a(t,e),t.prototype.sourceName="uploaded";function t(e){t.__super__.constructor.apply(this,arguments),e?(this.fileId=e.uuid,this.__handleFileData(e)):this.__rejectApi("deleted")}return t}(e.BaseFile)})}.call(this),function(){var t,i,n,a,r,o,l=[].slice,s={}.hasOwnProperty,u=function(e,t){for(var i in t)s.call(t,i)&&(e[i]=t[i]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=e.namespace,t=e.jQuery,r=e.utils,o=e.locale,a=o.t,n=e.settings,i("files",function(i){return i.FileGroup=function(){function e(e,i){var a=this;this.__uuid=null,this.settings=n.build(i),this.__fileColl=new r.CollectionOfPromises(e),this.__allFilesDf=t.when.apply(t,this.files()),this.__fileInfosDf=function(){var i;return e=function(){var e,n,a,r;for(a=this.files(),r=[],e=0,n=a.length;n>e;e++)i=a[e],r.push(i.then(null,function(e,i){return t.when(i)}));return r}.call(a),t.when.apply(t,e)}(),this.__createGroupDf=t.Deferred(),this.__initApiDeferred()}return e.prototype.files=function(){return this.__fileColl.get()},e.prototype.__save=function(){var e=this;return this.__saved?void 0:(this.__saved=!0,this.__allFilesDf.done(function(){return e.__createGroup().done(function(t){return e.__uuid=t.id,e.__buildInfo(function(t){return e.settings.imagesOnly&&!t.isImage?e.__createGroupDf.reject("image",t):e.__createGroupDf.resolve(t)})}).fail(function(){return e.__createGroupDf.reject("createGroup")})}))},e.prototype.promise=function(){return this.__save(),this.__apiDf.promise()},e.prototype.__initApiDeferred=function(){var e,i,n,a=this;return this.__apiDf=t.Deferred(),this.__progressState="uploading",i=function(e){return a.__buildInfo(function(t){return a.__apiDf.reject(e,t)})},n=function(e){return a.__apiDf.resolve(e)},e=function(){return a.__apiDf.notify(a.__progressInfo())},e(),this.__fileColl.onAnyProgress(e),this.__allFilesDf.done(function(){return a.__progressState="uploaded",e()}).fail(i),this.__createGroupDf.done(function(t){return a.__progressState="ready",e(),n(t)}).fail(i)},e.prototype.__progressInfo=function(){var e,t,i,n,a;for(e=0,i=this.__fileColl.lastProgresses(),n=0,a=i.length;a>n;n++)t=i[n],e+=((null!=t?t.progress:void 0)||0)/i.length;return{state:this.__progressState,uploadProgress:e,progress:"ready"===this.__progressState?1:.9*e}},e.prototype.__buildInfo=function(e){var t;return t={uuid:this.__uuid,cdnUrl:this.__uuid?""+this.settings.cdnBase+"/"+this.__uuid+"/":null,name:a("file",this.__fileColl.length()),count:this.__fileColl.length(),size:0,isImage:!0,isStored:!0},this.__fileInfosDf.done(function(){var i,n,a,r;for(i=1<=arguments.length?l.call(arguments,0):[],n=0,r=i.length;r>n;n++)a=i[n],t.size+=a.size,a.isImage||(t.isImage=!1),a.isStored||(t.isStored=!1);return e(t)})},e.prototype.__createGroup=function(){var e,i=this;return e=t.Deferred(),this.__fileColl.length()?this.__fileInfosDf.done(function(){var t,n;return n=1<=arguments.length?l.call(arguments,0):[],r.jsonp(""+i.settings.urlBase+"/group/","POST",{pub_key:i.settings.publicKey,files:function(){var e,i,a;for(a=[],e=0,i=n.length;i>e;e++)t=n[e],a.push("/"+t.uuid+"/"+(t.cdnUrlModifiers||""));return a}()}).fail(function(t){return i.settings.debugUploads&&r.log("Can't create group.",i.settings.publicKey,t),e.reject()}).done(e.resolve)}):e.reject(),e.promise()},e.prototype.api=function(){return this.__api||(this.__api=r.bindAll(this,["promise","files"])),this.__api},e}(),i.SavedFileGroup=function(t){u(i,t);function i(t,n){var a;this.__data=t,a=e.filesFrom("ready",this.__data.files,n),i.__super__.constructor.call(this,a,n)}return i.prototype.__createGroup=function(){return r.wrapToPromise(this.__data)},i}(i.FileGroup)}),i("",function(i){return i.FileGroup=function(t,i){var n,a,o,l,s,u,c,d;for(null==t&&(t=[]),a=[],l=0,u=t.length;u>l;l++)if(o=t[l],r.isFile(o))a.push(o);else if(r.isFileGroup(o))for(d=o.files(),s=0,c=d.length;c>s;s++)n=d[s],a.push(n);return new e.files.FileGroup(a,i).api()},i.loadFileGroup=function(i,a){var o,l,s=this;return a=n.build(a),o=t.Deferred(),l=r.groupIdRegex.exec(i),l?r.jsonp(""+a.urlBase+"/group/info/",{jsonerrors:1,pub_key:a.publicKey,group_id:l[0]}).fail(function(e){return a.debugUploads&&r.log("Can't load group info. Probably removed.",l[0],a.publicKey,e),o.reject()}).done(function(t){var i;return i=new e.files.SavedFileGroup(t,a),o.resolve(i.api())}):o.reject(),o.promise()}}),i("utils",function(i){return i.isFileGroup=function(e){return e&&e.files&&e.promise},i.valueToGroup=function(n,a){var r,o;if(n)if(t.isArray(n))r=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)o=n[e],r.push(i.valueToFile(o,a));return r}(),n=e.FileGroup(r,a);else if(!i.isFileGroup(n))return e.loadFileGroup(n,a);return i.wrapToPromise(n||null)},i.isFileGroupsEqual=function(e,t){var n,a,r,o,l,s;if(e===t)return!0;if(!i.isFileGroup(e)||!i.isFileGroup(t))return!1;if(a=e.files(),r=t.files(),a.length!==r.length)return!1;for(o=l=0,s=a.length;s>l;o=++l)if(n=a[o],n!==r[o])return!1;return!0}})}.call(this),function(){var t,i,n,a;a=e.utils,t=e.jQuery,i=e.files,n=e.settings,e.namespace("",function(e){var a;return e.fileFrom=function(t,i,n){return e.filesFrom(t,[i],n)[0]},e.filesFrom=function(e,i,r){var o,l,s,u,c;for(r=n.build(r||{}),c=[],s=0,u=i.length;u>s;s++)l=i[s],o=null,t.isArray(l)&&(o=l[1],l=l[0]),
c.push(new a[e](l,r,o).promise());return c},a={object:i.ObjectFile,input:i.InputFile,url:i.UrlFile,uploaded:i.UploadedFile,ready:i.ReadyFile}})}.call(this),function(){var t,i,n={}.hasOwnProperty;t=e.expose,t("globals",e.settings.common),t("start"),t("initialize"),t("fileFrom"),t("filesFrom"),t("FileGroup"),t("loadFileGroup"),t("locales",function(){var t,a;t=e.locale.translations,a=[];for(i in t)n.call(t,i)&&a.push(i);return a}())}.call(this)}({},"//ucarecdn.com/widget/2.8.0/uploadcare/");